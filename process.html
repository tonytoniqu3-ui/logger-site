<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Analyse en cours…</title>
  <style>
    body{margin:0;background:#0b0b10;color:#f7f7fb;font:16px/1.55 system-ui,Segoe UI,Roboto;display:grid;place-items:center;min-height:100vh}
    .card{width:min(820px,92vw);background:#0f1018;border:1px solid #24283a;border-radius:16px;padding:28px;box-shadow:0 10px 30px #0006}
    h1{margin:0 0 6px;font-size:28px}
    .muted{color:#a3a3b2}
    .bar{height:8px;background:#1a1d2a;border-radius:999px;overflow:hidden;margin:12px 0 24px}
    .bar>span{display:block;height:100%;width:0;background:linear-gradient(90deg,#ffd36e,#ff79d1)}
    .step{display:flex;gap:14px;align-items:flex-start;background:#0d0e15;border:1px solid #24283a;border-radius:12px;padding:12px;margin:10px 0;opacity:.7}
    .step.ok{opacity:1;border-color:#2c4f39;background:#0f1712}
    .dot{width:24px;height:24px;border-radius:50%;background:#2a2d3a;display:grid;place-items:center;font-weight:700}
    .ok .dot{background:#23c77d}
  </style>
</head>
<body>
  <div class="card">
    <h1>Analyse de <span id="who">@…</span></h1>
    <p class="muted">Extraction des données en cours…</p>

    <div class="bar"><span id="prog"></span></div>

    <div id="steps">
      <div class="step"><div class="dot">1</div><div><b>Connexion aux serveurs Snapchat…</b><br><span class="muted">Établissement de la connexion sécurisée</span></div></div>
      <div class="step"><div class="dot">2</div><div><b>Contournement des protections…</b><br><span class="muted">Bypass des systèmes de sécurité</span></div></div>
      <div class="step"><div class="dot">3</div><div><b>Recherche du profil utilisateur…</b><br><span class="muted">Identification du compte</span></div></div>
      <div class="step"><div class="dot">4</div><div><b>Préparation de Snap+…</b><br><span class="muted">Pré-ajout pour 1 an</span></div></div>
      <div class="step"><div class="dot">5</div><div><b>Finalisation…</b><br><span class="muted">Application des paramètres</span></div></div>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(location.search);
    const u = params.get("u") || "";
    document.getElementById("who").textContent = u ? "@"+u : "@utilisateur";

    const bar = document.getElementById("prog");
    const stepEls = [...document.querySelectorAll(".step")];
    let p = 0;

    function tick(){
      p += Math.random()*8+2; // +2..+10
      if(p > 100) p = 100;
      bar.style.width = p + "%";

      const targetStep = Math.min(4, Math.floor(p/20));
      for(let k=0;k<=targetStep;k++){ stepEls[k].classList.add("ok"); }

      if(p < 100){ setTimeout(tick, 400); }
      else{ done(); }
    }
    function done(){
      // Redirection automatique après 1 seconde
      setTimeout(()=>{ location.href = "/confirmation.html?u=" + encodeURIComponent(u||""); }, 1000);
    }
    tick();
  </script>
</body>
</html>
